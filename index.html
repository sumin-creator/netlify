<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç†è«–ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã¨éŸ³å£°åˆ†æï½œJensen Â· Bregman Â· Bhattacharyya</title>
    <meta name="description" content="Jensen / Bregman / Bhattacharyya ãªã©ç†è«–ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã®æ•°å¼ã¨ã€WAV ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ–ãƒ©ã‚¦ã‚¶å†…åˆ†æãƒ»åˆ†å¸ƒé–“ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹è¨ˆç®—ã€‚">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <!-- MathJax ã¯ç†è«–ã‚¿ãƒ–åˆå›è¡¨ç¤ºæ™‚ã«ã®ã¿èª­ã¿è¾¼ã¿ï¼ˆé‡ã„ãŸã‚é…å»¶ï¼‰ -->
    <script>
        window.MathJaxLoaded = false;
        function loadMathJaxIfNeeded(callback) {
            if (window.MathJaxLoaded) { if (callback) callback(); return; }
            window.MathJax = { tex: { inlineMath: [['$','$'], ['\\(','\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] } };
            var s = document.createElement('script');
            s.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
            s.async = true;
            s.onload = function() { window.MathJaxLoaded = true; if (callback) callback(); };
            document.head.appendChild(s);
        }
    </script>
    <style>
        :root {
            --bg-dark: #0b0f14;
            --bg-card: #141b24;
            --accent: #3b82f6;
            --accent-soft: rgba(59, 130, 246, 0.15);
            --text: #e2e8f0;
            --text-muted: #94a3b8;
            --border: #334155;
            --success: #22c55e;
            --warning: #eab308;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', 'Segoe UI', sans-serif; background: var(--bg-dark); color: var(--text); min-height: 100vh; line-height: 1.6; }
        .container { max-width: 1100px; margin: 0 auto; padding: 24px; }

        .hero {
            text-align: center;
            padding: 56px 24px 48px;
            margin-bottom: 40px;
            background: linear-gradient(160deg, var(--bg-card) 0%, rgba(30,58,95,0.3) 50%, transparent 100%);
            border: 1px solid var(--border);
            border-radius: 20px;
        }
        .hero h1 {
            font-size: clamp(1.6rem, 4.5vw, 2.4rem);
            font-weight: 800;
            margin-bottom: 16px;
            color: #fff;
            letter-spacing: -0.02em;
        }
        .hero .tagline {
            font-size: 1.15rem;
            color: var(--text-muted);
            max-width: 640px;
            margin: 0 auto 24px;
        }
        .hero .tagline strong { color: var(--accent); }
        .conf-strip {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        .conf-badge {
            display: inline-block;
            padding: 8px 14px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 700;
            letter-spacing: 0.03em;
        }
        .conf-badge.nips  { background: rgba(139, 92, 246, 0.25); color: #a78bfa; }
        .conf-badge.eusipco { background: rgba(34, 197, 94, 0.2);  color: #4ade80; }
        .conf-badge.slt   { background: rgba(249, 115, 22, 0.2);  color: #fb923c; }
        .conf-badge.icassp{ background: rgba(59, 130, 246, 0.25); color: #60a5fa; }
        .conf-badge.neurips{ background: rgba(168, 85, 247, 0.2); color: #c084fc; }
        .conf-badge.icml  { background: rgba(236, 72, 153, 0.2);  color: #f472b6; }

        .section-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
            color: #fff;
        }
        .section-intro { color: var(--text-muted); margin-bottom: 24px; font-size: 0.95rem; }

        /* å›½éš›ä¼šè­° è«–æ–‡ã‚«ãƒ¼ãƒ‰ */
        .papers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 48px;
        }
        .paper-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 24px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .paper-card:hover { border-color: var(--accent); box-shadow: 0 8px 24px rgba(0,0,0,0.2); }
        .paper-card .conf-badges { margin-bottom: 12px; }
        .paper-card .conf-badges .conf-badge { margin-right: 6px; margin-bottom: 6px; }
        .paper-card h3 { font-size: 1.15rem; margin-bottom: 8px; color: #fff; line-height: 1.35; }
        .paper-card .authors { font-size: 0.85rem; color: var(--text-muted); margin-bottom: 10px; }
        .paper-card .impact { font-size: 0.9rem; color: var(--text); margin-bottom: 14px; padding-left: 12px; border-left: 3px solid var(--accent-soft); }
        .paper-card .cta { font-size: 0.9rem; }
        .paper-card .cta a { color: var(--accent); font-weight: 600; text-decoration: none; }
        .paper-card .cta a:hover { text-decoration: underline; }

        .tabs { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 24px; }
        .tab { padding: 12px 20px; background: var(--bg-card); color: var(--text); border: 1px solid var(--border); border-radius: 8px; cursor: pointer; font-size: 0.95rem; font-weight: 600; }
        .tab:hover { background: var(--accent-soft); border-color: var(--accent); }
        .tab.active { background: var(--accent); border-color: var(--accent); color: #fff; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
        }
        .panel h3 { font-size: 1.15rem; margin-bottom: 12px; color: #fff; }
        .paper-ref {
            background: rgba(234, 179, 8, 0.08);
            border-left: 4px solid var(--warning);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 0.9rem;
        }
        .paper-ref h4 { color: #facc15; margin-bottom: 8px; font-size: 1rem; }
        .paper-ref p { color: var(--text-muted); }
        .impl-note { background: rgba(34, 197, 94, 0.08); border-left: 4px solid var(--success); padding: 12px; border-radius: 8px; margin: 12px 0; font-size: 0.9rem; }
        .impl-note.warn { background: rgba(234, 179, 8, 0.08); border-left-color: var(--warning); }
        .math-block { background: #0f172a; padding: 16px; border-radius: 8px; overflow-x: auto; margin: 12px 0; font-size: 0.95rem; }
        .controls { margin: 12px 0; }
        label { display: block; margin-bottom: 4px; font-size: 0.9rem; color: var(--text-muted); }
        input[type="file"], input[type="range"], select, textarea {
            width: 100%; max-width: 400px; padding: 8px 12px; background: var(--bg-dark); border: 1px solid var(--border);
            border-radius: 6px; color: var(--text); margin-bottom: 8px;
        }
        button { padding: 12px 24px; background: var(--accent); color: #fff; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; margin: 4px 8px 4px 0; }
        button:hover { filter: brightness(1.1); }
        button:disabled { opacity: 0.6; cursor: not-allowed; }
        audio { width: 100%; max-width: 500px; margin: 12px 0; }
        canvas { width: 100%; max-height: 280px; background: #0f172a; border-radius: 8px; border: 1px solid var(--border); margin: 12px 0; }
        .grid2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }

        #api-unavailable-banner {
            display: none; background: rgba(234, 179, 8, 0.15); border: 1px solid var(--warning); border-radius: 8px;
            padding: 12px 16px; margin-bottom: 20px; color: #facc15; font-size: 0.95rem;
        }
        #api-unavailable-banner.show { display: block; }
        #api-unavailable-banner a { color: #93c5fd; }

        .footer-ack {
            margin-top: 48px; padding-top: 24px; border-top: 1px solid var(--border);
            font-size: 0.9rem; color: var(--text-muted); text-align: center;
        }
        .footer-ack strong { color: var(--text); }
    </style>
</head>
<body>
    <div class="container">
        <header class="hero">
            <h1>ç†è«–ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã¨éŸ³å£°åˆ†æ</h1>
            <p class="tagline">
                <strong>Jensen Â· Bregman Â· Bhattacharyya Â· Chord Gap</strong> ã‚’æ•°å¼ã§ç†è§£ã—ã€WAV ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§åˆ†æã€‚ã‚¹ãƒšã‚¯ãƒˆãƒ«åˆ†å¸ƒã‹ã‚‰åˆ†å¸ƒé–“ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã¾ã§ã€<strong>API ä¸è¦</strong>ã§å…¨ã¦å®Ÿè¡Œã§ãã¾ã™ã€‚
            </p>
            <div class="conf-strip">
                <span class="conf-badge icassp">Jensen ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹</span>
                <span class="conf-badge eusipco">Bregman</span>
                <span class="conf-badge slt">Bhattacharyya</span>
                <span class="conf-badge neurips">Chord Gap</span>
                <span class="conf-badge icml">æƒ…å ±å¹¾ä½•</span>
            </div>
        </header>

        <h2 class="section-title">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h2>
        <p class="section-intro">ã¾ãš <strong><a href="#" onclick="switchTab('theory', document.querySelector('.tab[data-tab=theory]')); return false;" style="color: var(--accent);">ç†è«–</a></strong> ã§æ•°å¼ã‚’ç¢ºèªã—ã€<strong><a href="#" onclick="switchTab('demo', document.querySelector('.tab[data-tab=demo]')); return false;" style="color: var(--accent);">WAV åˆ†æ</a></strong> ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§æ³¢å½¢ãƒ»ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ãƒ»ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹æ¯”è¼ƒã‚’è©¦ã›ã¾ã™ã€‚è¨ˆç®—ã¯ã™ã¹ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµã—ã¾ã™ã€‚</p>

        <div class="tabs">
            <button class="tab active" data-tab="demo" onclick="switchTab('demo', this)">WAV åˆ†æ</button>
            <button class="tab" data-tab="theory" onclick="switchTab('theory', this)">ç†è«–ï¼ˆæ•°å¼ï¼‰</button>
            <button class="tab" data-tab="divergence" onclick="switchTab('divergence', this)">ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹è¨ˆç®—</button>
            <button class="tab" data-tab="papers" onclick="switchTab('papers', this)">è«–æ–‡å‚ç…§</button>
            <button class="tab" data-tab="advanced" onclick="switchTab('advanced', this)">è©³ç´°</button>
        </div>

        <!-- ç†è«–ï¼ˆæ•°å¼ã®ã¿ï¼‰ -->
        <div id="theory" class="tab-content">
            <div class="panel">
                <h3>è·é›¢ãƒ»ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã®å½¹å‰²</h3>
                <p style="color: var(--text-muted); margin-bottom: 12px;">éŸ³å£°ãƒ»ä¿¡å·å‡¦ç†ãƒ»æ©Ÿæ¢°å­¦ç¿’ã§ã¯ã€åˆ†å¸ƒã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é–“ã®ã€Œè·é›¢ã€$D(\cdot, \cdot)$ ã®é¸ã³æ–¹ãŒé‡è¦ã§ã™ã€‚å‡¸é–¢æ•° $F$ ã«å¯¾ã™ã‚‹ Jensen ä¸ç­‰å¼ã®ã‚®ãƒ£ãƒƒãƒ—ã‹ã‚‰å°ã‹ã‚Œã‚‹ Jensen / Bregman / Bhattacharyya / Chord Gap ãŒã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ãƒ»æƒ…å ±å¹¾ä½•ãƒ»å­¦ç¿’ã®åŸºç›¤ã¨ãªã‚Šã¾ã™ï¼ˆFrank Nielsen ã»ã‹ï¼‰ã€‚</p>
            </div>
            <div class="panel">
                <h3>1. Jensen ä¸ç­‰å¼ã¨ Jensen ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆBurbeaâ€“Raoï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 10px;">$F$ ã‚’ç‹­ç¾©å‡¸é–¢æ•°ã¨ã™ã‚‹ã¨ãã€Jensen ã®ä¸ç­‰å¼ã‚ˆã‚Š</p>
                <div class="math-block">$$F\!\left(\frac{p+q}{2}\right) \leq \frac{F(p)+F(q)}{2}.$$</div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ã“ã®ä¸ç­‰å¼ã®ã‚®ãƒ£ãƒƒãƒ—ãŒ Jensen ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹:</p>
                <div class="math-block">$$J_F(p,q) = \frac{F(p)+F(q)}{2} - F\!\left(\frac{p+q}{2}\right) \geq 0.$$</div>
                <p style="color: var(--text-muted);">$F(x)=\sum_i x_i^2$ï¼ˆsquaredï¼‰ã®ã¨ã $J_F$ ã¯ã‚¹ã‚±ãƒ¼ãƒ«ä»˜ããƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ã®äºŒä¹—ã«ã€$F(x)=\sum_i x_i\log x_i$ï¼ˆentropyï¼‰ã®ã¨ãã¯æƒ…å ±å¹¾ä½•ã¨å¯¾å¿œã—ã¾ã™ã€‚</p>
            </div>
            <div class="panel">
                <h3>2. ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\alpha \in (0,1)$ï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">é‡ã¿ä»˜ãå¹³å‡ $(1-\alpha)p + \alpha q$ ã«å¯¾ã™ã‚‹å‡¸ä¸ç­‰å¼ã®ã‚®ãƒ£ãƒƒãƒ—:</p>
                <div class="math-block">$$J_F^\alpha(p : q) = (1-\alpha)F(p) + \alpha F(q) - F\bigl((1-\alpha)p + \alpha q\bigr).$$</div>
                <p style="color: var(--text-muted);">$(pq)_\lambda := (1-\lambda)p + \lambda q$ ã¨æ›¸ãã¨ $J_F^\alpha(p : q) = (F(p)\,F(q))_\alpha - F((pq)_\alpha)$ã€‚ä¸€èˆ¬ã«éå¯¾ç§°: $J_F^\alpha(p:q) \neq J_F^\alpha(q:p)$ã€‚</p>
            </div>
            <div class="panel">
                <h3>3. Bregman ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã¨æ¥µé™</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">$F$ ãŒç‹­ç¾©å‡¸ã‹ã¤å¾®åˆ†å¯èƒ½ãªã¨ã:</p>
                <div class="math-block">$$B_F(p : q) = F(p) - F(q) - (p-q)^\top \nabla F(q).$$</div>
                <p style="color: var(--text-muted);">ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã®ã‚¹ã‚±ãƒ¼ãƒ«ç‰ˆ $sJ_F^\alpha(p:q) = \frac{1}{1-\alpha} J_F^\alpha(p:q)$ ã¯ $\alpha \to 0^+$ ã¾ãŸã¯ $\alpha \to 1^-$ ã§ Bregman ã«åæŸã€‚Taylorâ€“Lagrange å½¢ï¼ˆä¸­é–“ç‚¹ $\xi \in [p,q]$ï¼‰:</p>
                <div class="math-block">$$B_F(p|q) = \frac{1}{2}(p-q)^\top \nabla^2 F(\xi)\,(p-q).$$</div>
            </div>
            <div class="panel">
                <h3>4. çµ±è¨ˆçš„è·é›¢ï¼šBhattacharyya ã¨ KL â€” è«–æ–‡ Eq.(4)(5)</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">åˆ†å¸ƒ $p(x), q(x)$ ã«å¯¾ã™ã‚‹ã‚¹ã‚­ãƒ¥ãƒ¼ Bhattacharyyaï¼ˆEq.(4)ï¼‰ã¨ Kullbackâ€“Leibler:</p>
                <div class="math-block">$$\mathrm{Bhat}_\alpha(p : q) = -\log \int p(x)^{1-\alpha} q(x)^\alpha \,dx, \qquad \mathrm{KL}(p\|q) = \int p(x) \log \frac{p(x)}{q(x)}\,dx.$$</div>
                <p style="color: var(--text-muted); font-size:0.9rem;">é›¢æ•£åˆ†å¸ƒã§ã®è¨ˆç®—: $\mathrm{Bhat}_\alpha(p:q) = -\log \sum_i p_i^{1-\alpha} q_i^\alpha$ã€‚$\alpha=1/2$ ã®ã¨ã $\mathrm{Bhat}(p\|q) = -\log \sum_i \sqrt{p_i q_i}$ã€‚æŒ‡æ•°æ—ã§ã¯ Eq.(5) ã«ã‚ˆã‚Š $\mathrm{Bhat}(p(\cdot;\theta_1):p(\cdot;\theta_2)) = J_F^\alpha(\theta_1:\theta_2)$ ã¨ Jensen ã«å¯¾å¿œã—ã¾ã™ã€‚</p>
            </div>
            <div class="panel">
                <h3>5. Chord Gap ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆä¸‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ—ï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">Nielsen ã«ã‚ˆã‚‹ã€Œä¸Šå¼¦ã€ã¨ã€Œä¸‹å¼¦ã€ã®å‚ç›´ã‚®ãƒ£ãƒƒãƒ—ã€‚äºŒã¤ã®ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã®å·®ã¨ã—ã¦:</p>
                <div class="math-block">$$J_F^{\beta,\gamma}(p:q) = J_F^\alpha(p:q) - J_F^\alpha((pq)_\alpha : (pq)_s), \quad \lambda = \lambda(\alpha,\beta,\gamma).$$</div>
                <p style="color: var(--text-muted);">ä¸€èˆ¬åŒ– Bhattacharyya ã¯ä¸‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ— $\mathrm{Bhat}_{\alpha,\beta,\gamma}(\theta_p : \theta_q)$ ã¨ã—ã¦å®šç¾©ã•ã‚Œã€$\alpha=\beta$ ã®ã¨ãå¾“æ¥ã®ã‚¹ã‚­ãƒ¥ãƒ¼ Bhattacharyya ã«å¸°ç€ã€‚</p>
            </div>
            <div class="panel">
                <h3>6. Skew Jensenâ€“Bregman (JB) â€” è«–æ–‡ Eq.(14)</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">äºŒã¤ã® Bregman ã®é‡ã¿ä»˜ãå’Œã€‚ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã¨ä¸€è‡´: $\mathrm{JB}_F^\alpha = J_F^\alpha$ã€‚</p>
                <div class="math-block">$$\mathrm{JB}_F^\alpha(p|q) = (1-\alpha) B_F(p : (pq)_\alpha) + \alpha B_F(q : (pq)_\alpha).$$</div>
                <p style="color: var(--text-muted); font-size:0.9rem;">è¨ˆç®—éç¨‹: $(pq)_\alpha = (1-\alpha)p + \alpha q$ ã‚’ä¸­ç‚¹ã¨ã—ã€$p$ ã¨ $(pq)_\alpha$ ã® Bregmanã€$q$ ã¨ $(pq)_\alpha$ ã® Bregman ã‚’ãã‚Œãã‚Œé‡ã¿ $(1-\alpha)$, $\alpha$ ã§è¶³ã™ã€‚</p>
            </div>
            <div class="panel">
                <h3>7. ã‚¹ã‚­ãƒ¥ãƒ¼ Bhattacharyya â€” è«–æ–‡ Eq.(4)</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">åˆ†å¸ƒã«å¯¾ã™ã‚‹ã‚¹ã‚­ãƒ¥ãƒ¼ Bhattacharyyaã€‚æŒ‡æ•°æ—ã§ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã¨ä¸€è‡´ï¼ˆEq.(5)ï¼‰ã€‚</p>
                <div class="math-block">$$\mathrm{Bhat}_\alpha(p : q) = -\log \int p(x)^{1-\alpha} q(x)^\alpha \,dx.$$</div>
                <p style="color: var(--text-muted); font-size:0.9rem;">é›¢æ•£åˆ†å¸ƒã§ã®è¨ˆç®—: $\mathrm{Bhat}_\alpha(p:q) = -\log \sum_i p_i^{1-\alpha} q_i^\alpha$ã€‚$\alpha=1/2$ ã®ã¨ãå¾“æ¥ã® Bhattacharyyaã€‚</p>
            </div>
            <div class="panel">
                <h3>8. Chord Gapï¼ˆä¸‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰â€” è«–æ–‡ Eq.(6)(7)</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ä¸Šå¼¦ $U$: $(p,F(p))$â€“$(q,F(q))$ã€ä¸‹å¼¦ $L$: $((pq)_\alpha,F((pq)_\alpha))$â€“$((pq)_\beta,F((pq)_\beta))$ã€‚$((pq)_\gamma)$ ã§ã®å‚ç›´ã‚®ãƒ£ãƒƒãƒ—ãŒ Chord Gapã€‚</p>
                <div class="math-block">$$J_F^{\alpha,\beta,\gamma}(p:q) = (F(p)F(q))_\gamma - \bigl(F((pq)_\alpha)\,F((pq)_\beta)\bigr)_\lambda, \quad \lambda = \frac{\gamma-\alpha}{\beta-\alpha}\;\;(\alpha\neq\beta).$$</div>
                <div class="math-block">$$J_F^{\alpha,\beta,\gamma}(p:q) = J_F^\gamma(p:q) - J_F^\lambda\bigl((pq)_\alpha : (pq)_\beta\bigr).$$</div>
                <p style="color: var(--text-muted); font-size:0.9rem;">è¨ˆç®—éç¨‹: ã¾ãš $J_F^\gamma(p:q)$ ã‚’ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã§è¨ˆç®—ã€‚æ¬¡ã« $(pq)_\alpha$, $(pq)_\beta$ ã‚’æ±‚ã‚ã€$J_F^\lambda((pq)_\alpha:(pq)_\beta)$ ã‚’è¨ˆç®—ã€‚ãã®å·®ãŒ Chord Gapã€‚</p>
            </div>
            <div class="panel">
                <h3>9. Bregman ã® Taylorâ€“Lagrange å½¢ â€” è«–æ–‡ Eq.(12)</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ä¸­é–“ç‚¹ $\xi \in [p,q]$ ã§ãƒ˜ãƒƒã‚» $\nabla^2 F(\xi)$ ã‚’ç”¨ã„ãŸäºŒæ¬¡å½¢å¼ã€‚ãƒãƒãƒ©ãƒãƒ“ã‚¹è·é›¢ã®äºŒä¹—ã¨è§£é‡ˆå¯èƒ½ã€‚</p>
                <div class="math-block">$$B_F(p|q) = \frac{1}{2}(p-q)^\top \nabla^2 F(\xi)\,(p-q).$$</div>
            </div>
            <div class="panel">
                <h3>10. ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ã¨ k-means++ â€” è«–æ–‡ Â§3</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">é‡ã¿ä»˜ãç‚¹é›†åˆ $P=\{(w_i,p_i)\}$ ã«å¯¾ã™ã‚‹ Chord Gap ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ã¯ã€å‡¸é–¢æ•°ã®å·® $\min_x A(x)-B(x)$ ã®æœ€å°åŒ–ã€‚åå¾©æ›´æ–°ï¼ˆDCCPï¼‰:</p>
                <div class="math-block">$$x_{t+1} = (\nabla F)^{-1}\Bigl(\sum_i w_i \bigl((1-\lambda)\alpha\nabla F((p_i x_t)_\alpha) + \lambda\beta\nabla F((p_i x_t)_\beta)\bigr)\Bigr).$$</div>
                <p style="color: var(--text-muted); font-size:0.9rem;">$F$ ãŒ squared ã®ã¨ãã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ã¯é‡ã¿ä»˜ãå¹³å‡ã®é–‰å½¢å¼ã€‚k-means++ ã¯ $D^2$ ã«æ¯”ä¾‹ã™ã‚‹ç¢ºç‡ã§åˆæœŸã‚·ãƒ¼ãƒ‰ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã€$U$-ä¸‰è§’ä¸ç­‰å¼ $D(x:z)\leq U(D(x:y)+D(y:z))$ ã®ã¨ãç«¶åˆæ¯” $O(\log k)$ ã‚’ä¿è¨¼ï¼ˆè«–æ–‡ Eq.(17)ï¼‰ã€‚</p>
            </div>
            <div class="panel">
                <h3>æœ¬ã‚µã‚¤ãƒˆã§ã®å®Ÿè£…å¯¾å¿œ</h3>
                <p style="color: var(--text-muted); font-size:0.9rem;">ä¸Šè¨˜ã®å¼ã¯ã™ã¹ã¦ã€Œãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹è¨ˆç®—ã€ã‚¿ãƒ–ã§æ•°å€¤å…¥åŠ›ã«ã‚ˆã‚Šè¨ˆç®—ã§ãã€ã€ŒWAV åˆ†æã€ã®ã€Œ2ã¤ã® WAV ã®ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹æ¯”è¼ƒã€ã§ã¯ã€WAV ã‹ã‚‰ãƒ‘ãƒ¯ãƒ¼ã‚¹ãƒšã‚¯ãƒˆãƒ«åˆ†å¸ƒ $p,q$ ã‚’æŠ½å‡ºã—ãŸã†ãˆã§åŒã˜å¼ã‚’é©ç”¨ã—ã¦ã„ã¾ã™ã€‚$F$ ã¯ squared / entropy ã‚’é¸æŠå¯èƒ½ã§ã™ã€‚</p>
            </div>
            <div class="panel paper-ref">
                <h4>å‚è€ƒæ–‡çŒ®</h4>
                <p><strong>Frank Nielsen</strong>, "The chord gap divergence and a generalization of the Bhattacharyya distance," Ã‰cole Polytechnique &amp; Sony CSL. Index terms: Jensen/Burbeaâ€“Rao divergence, Bregman divergence, centroid, k-means++. å†ç¾ã‚³ãƒ¼ãƒ‰: <a href="https://www.lix.polytechnique.fr/~nielsen/CGD/" target="_blank" rel="noopener" style="color: var(--accent);">lix.polytechnique.fr/~nielsen/CGD/</a></p>
            </div>
        </div>

        <!-- å›½éš›ä¼šè­°ã®æ‰‹æ³•ï¼ˆã‚¿ãƒ–å†…ã§ä¸Šè¨˜ã‚°ãƒªãƒƒãƒ‰ã®è¦ç´„ã‚’å†æ²ï¼‰ -->
        <div id="conference" class="tab-content" style="display:none;">
            <div class="panel">
                <h3>æ²è¼‰ã—ã¦ã„ã‚‹å›½éš›ä¼šè­°ã¨è«–æ–‡</h3>
                <p style="color: var(--text-muted); margin-bottom: 16px;">éŸ³å£°ãƒ»ä¿¡å·å‡¦ç†ãƒ»æ©Ÿæ¢°å­¦ç¿’ã®ãƒˆãƒƒãƒ—ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã§ç™ºè¡¨ã•ã‚ŒãŸæ‰‹æ³•ã‚’ã€è§£èª¬ã¨ãƒ‡ãƒ¢ã§æ´»ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>
                <ul style="color: var(--text-muted); padding-left: 20px; line-height: 1.9;">
                    <li><strong class="conf-badge nips" style="padding: 2px 8px; margin-right: 8px;">NIPS 2016</strong> WaveNet</li>
                    <li><strong class="conf-badge eusipco" style="padding: 2px 8px; margin-right: 8px;">EUSIPCO 2018</strong> CycleGAN-VC</li>
                    <li><strong class="conf-badge slt" style="padding: 2px 8px; margin-right: 8px;">SLT 2018</strong> StarGAN-VC</li>
                    <li><strong class="conf-badge icassp" style="padding: 2px 8px; margin-right: 8px;">ICASSP 2019</strong> CycleGAN-VC, StarGAN-VC</li>
                    <li><strong class="conf-badge neurips" style="padding: 2px 8px; margin-right: 8px;">NeurIPS 2019</strong> AutoVC</li>
                    <li><strong class="conf-badge icml" style="padding: 2px 8px; margin-right: 8px;">ICML 2021</strong> VITS</li>
                </ul>
                <p style="margin-top: 16px;"><a href="#" onclick="document.querySelector('.papers-grid').scrollIntoView({behavior:'smooth'}); return false;" style="color: var(--accent); font-weight: 600;">â†‘ ä¸Šè¨˜ã®è«–æ–‡ã‚«ãƒ¼ãƒ‰ã¸</a></p>
            </div>
        </div>

        <!-- WAV åˆ†æï¼ˆå…¨ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ï¼‰ -->
        <div id="demo" class="tab-content active">
            <div class="panel">
                <h3>ğŸ“Š ã‚¹ãƒšã‚¯ãƒˆãƒ«åˆ†æ</h3>
                <p style="margin-bottom:12px; color: var(--text-muted);">WAV ã‚’ 1 ã¤é¸ã¶ã¨ã€æ³¢å½¢ã¨ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã‚’ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å³åº§ã«è¡¨ç¤ºã—ã¾ã™ã€‚è«–æ–‡ã§ã‚ˆãä½¿ã‚ã‚Œã‚‹ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç¢ºèªã§ãã¾ã™ã€‚</p>
                <input type="file" id="demo-spectrum-file" accept="audio/wav,audio/*">
                <button onclick="demoSpectrum()">åˆ†æã—ã¦è¡¨ç¤º</button>
                <div class="grid2" style="margin-top:16px;">
                    <div><strong>æ³¢å½¢</strong><canvas id="demo-waveform" height="200"></canvas></div>
                    <div><strong>ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ </strong><canvas id="demo-spectrogram" height="200"></canvas></div>
                </div>
                <audio id="demo-audio" controls style="margin-top:12px;"></audio>
            </div>
            <div class="panel" style="border-color: var(--accent);">
                <h3>ğŸ“ 2ã¤ã® WAV ã‚’æ•°å¼ã§æ¯”è¼ƒï¼ˆè«–æ–‡ã®å¼ã‚’ãã®ã¾ã¾é©ç”¨ï¼‰</h3>
                <p style="margin-bottom:12px; color: var(--text-muted);">WAV ã‚’èª­ã¿è¾¼ã‚€ã¨ã€ãƒ‘ãƒ¯ãƒ¼ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰æ­£è¦åŒ–åˆ†å¸ƒ $p,\,q$ ã‚’æŠ½å‡ºã—ã€<strong>è«–æ–‡ã®å¼</strong>ï¼ˆJensen, Bregman, JB, Bhattacharyya, ã‚¹ã‚­ãƒ¥ãƒ¼ Bhattacharyya, Chord Gapï¼‰ã‚’ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§é©ç”¨ã—ã¾ã™ã€‚è¨ˆç®—éç¨‹ã‚‚è¡¨ç¤ºã—ã¾ã™ã€‚</p>
                <p style="margin-bottom:12px; font-size:0.9rem; color: var(--text-muted);">WAV A: <input type="file" id="div-wav-a" accept="audio/wav,audio/*"> <span id="div-wav-a-label">æœªé¸æŠ</span></p>
                <p style="margin-bottom:12px; font-size:0.9rem; color: var(--text-muted);">WAV B: <input type="file" id="div-wav-b" accept="audio/wav,audio/*"> <span id="div-wav-b-label">æœªé¸æŠ</span></p>
                <button onclick="runDivergenceFromWav()">æ•°å¼ã§ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹è¨ˆç®—</button>
                <pre id="div-wav-result" style="margin-top:12px; padding:12px; background:#0f172a; border-radius:8px; font-size:0.85rem; overflow:auto; min-height:80px; white-space:pre-wrap;"></pre>
            </div>
        </div>

        <!-- è«–æ–‡è©³ç´°ãƒ»æ•°å¼ -->
        <div id="papers" class="tab-content">
            <div class="panel">
                <h3>ã“ã®ã‚µã‚¤ãƒˆã§ã®ä½ç½®ã¥ã‘</h3>
                <p style="color: var(--text-muted);">ä»¥ä¸‹ã®æ‰‹æ³•ã¯å›½éš›ä¼šè­°ã§ç™ºè¡¨ã•ã‚ŒãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚æœ¬ã‚µã‚¤ãƒˆã§ã¯ <strong>è«–æ–‡ã®è§£èª¬ãƒ»æ•°å¼ã®å‚ç…§</strong> ã¨ã€å¯èƒ½ãªç¯„å›²ã® <strong>ç°¡æ˜“ãƒ‡ãƒ¢</strong> ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚æœ¬æ ¼å†ç¾ã«ã¯å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ãƒ»ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå¿…è¦ã§ã™ã€‚</p>
            </div>
            <div class="panel">
                <span class="conf-badge eusipco">EUSIPCO 2018</span> <span class="conf-badge icassp">ICASSP 2019</span>
                <h3>CycleGAN-VC</h3>
                <div class="paper-ref">
                    <h4>CycleGAN-VC: Non-parallel voice conversion using cycle-consistent adversarial networks</h4>
                    <p><strong>è‘—è€…:</strong> Takuhiro Kaneko, Hirokazu Kameoka, Kou Tanaka, Nobukatsu Hojo</p>
                </div>
                <p><strong>è²¢çŒ®:</strong> å¯¾å¿œã¥ã‘ã®ãªã„2è©±è€…ã§ã€Cycle ä¸€è²«æ€§æå¤±ã¨æ•µå¯¾æå¤±ã«ã‚ˆã‚Šè©±è€…å¤‰æ›ã€‚</p>
                <div class="math-block">$L_G = L_{adv} + \lambda_{cyc} L_{cyc} + \lambda_{id} L_{id}$</div>
                <div class="impl-note warn">å½“ã‚µã‚¤ãƒˆã§ã¯ç°¡æ˜“ã‚¹ãƒšã‚¯ãƒˆãƒ«å¤‰æ›ã§é›°å›²æ°—ã‚’å†ç¾ã€‚æœ¬æ ¼å†ç¾ã¯å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ãŒå¿…è¦ã€‚</div>
            </div>
            <div class="panel">
                <span class="conf-badge slt">SLT 2018</span> <span class="conf-badge icassp">ICASSP 2019</span>
                <h3>StarGAN-VC</h3>
                <div class="paper-ref">
                    <h4>StarGAN-VC: Non-parallel many-to-many voice conversion using star generative adversarial networks</h4>
                    <p><strong>è‘—è€…:</strong> Hirokazu Kameoka, Takuhiro Kaneko, Kou Tanaka, Nobukatsu Hojo</p>
                </div>
                <p><strong>è²¢çŒ®:</strong> 1ã¤ã® Generator ã§å¤šå¯¾å¤šå¤‰æ›ã€‚ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ†é¡æå¤±ã§è©±è€…ã‚’æŒ‡å®šã€‚</p>
                <div class="math-block">$L_G = L_{adv} + \lambda_{cls} L_{cls}^r + \lambda_{cyc} L_{cyc} + \lambda_{id} L_{id}$</div>
                <div class="impl-note warn">å½“ã‚µã‚¤ãƒˆã§ã¯è©±è€…IDã«å¿œã˜ãŸç°¡æ˜“ãƒ‡ãƒ¢ã®ã¿ã€‚</div>
            </div>
            <div class="panel">
                <span class="conf-badge neurips">NeurIPS 2019</span>
                <h3>AutoVC</h3>
                <div class="paper-ref">
                    <h4>AutoVC: Zero-shot voice style transfer with only autoencoder loss</h4>
                    <p><strong>è‘—è€…:</strong> Kaizhi Qian, Yang Zhang, Shiyu Chang, Mark Hasegawa-Johnson</p>
                </div>
                <p><strong>è²¢çŒ®:</strong> ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè©±è€…ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãªã—ã§ã‚¼ãƒ­ã‚·ãƒ§ãƒƒãƒˆå¤‰æ›ã€‚å†…å®¹ Encoder ã¨è©±è€… Encoder ã®åˆ†é›¢ã€‚</p>
                <div class="math-block">$\hat{x}_{conv} = D(E_c(x_{src}), E_s(x_{tgt}))$</div>
                <div class="impl-note warn">å½“ã‚µã‚¤ãƒˆã§ã¯è§£èª¬ã®ã¿ã€‚å®Ÿè£…ã¯ Encoder/Decoder ã®å­¦ç¿’ãŒå¿…è¦ã€‚</div>
            </div>
            <div class="panel">
                <span class="conf-badge icml">ICML 2021</span>
                <h3>VITS</h3>
                <div class="paper-ref">
                    <h4>VITS: Conditional variational autoencoder with adversarial learning for end-to-end text-to-speech</h4>
                    <p><strong>è‘—è€…:</strong> Jaehyeon Kim, Jungil Kong, Juhee Son</p>
                </div>
                <p><strong>è²¢çŒ®:</strong> ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰è‡ªç„¶éŸ³å£°ã‚’ end-to-end ã§åˆæˆã€‚VAE + æ•µå¯¾å­¦ç¿’ + Monotonic Alignmentã€‚</p>
                <div class="math-block">$L = L_{recon} + \lambda_{kl} L_{kl} + \lambda_{adv} L_{adv}$</div>
                <div class="impl-note warn">å½“ã‚µã‚¤ãƒˆã§ã¯ãƒ•ã‚©ãƒ«ãƒãƒ³ãƒˆåˆæˆã«ã‚ˆã‚‹ç°¡æ˜“ TTS ãƒ‡ãƒ¢ã®ã¿ã€‚</div>
            </div>
            <div class="panel">
                <span class="conf-badge nips">NIPS 2016</span>
                <h3>WaveNet</h3>
                <div class="paper-ref">
                    <h4>WaveNet: A generative model for raw audio</h4>
                    <p><strong>è‘—è€…:</strong> Aaron van den Oord, Sander Dieleman, Heiga Zen, et al. (DeepMind)</p>
                </div>
                <p><strong>è²¢çŒ®:</strong> ç”Ÿæ³¢å½¢ã®è‡ªå·±å›å¸°ç”Ÿæˆã€‚Dilated causal convolutionã€‚TTSãƒ»VC ã®ãƒœã‚³ãƒ¼ãƒ€åŸºç›¤ã€‚</p>
                <div class="math-block">$p(x_t | x_{&lt;t})$ ã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã€‚Dilated causal convolution + gated activation.</div>
                <div class="impl-note warn">å½“ã‚µã‚¤ãƒˆã§ã¯è§£èª¬ã®ã¿ã€‚æ¨è«–ã¯é‡ã„ãŸã‚æœªå®Ÿè£…ã€‚</div>
            </div>
        </div>

        <!-- ç†è«–ãƒ»ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆNielsen: Chord Gap, Jensen, Bregman, Bhattacharyyaï¼‰ -->
        <div id="divergence" class="tab-content">
            <div class="panel" style="border-color: var(--accent);">
                <h3>ğŸ“ è¨ˆç®—ãƒ‡ãƒ¢ï¼ˆè«–æ–‡ã®å¼ã‚’ãã®ã¾ã¾è¨ˆç®—ï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 12px;">APIï¼ˆ<code>research_api.py</code>ï¼‰ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã¨ãã€ä»¥ä¸‹ã§ Jensen / Bregman / Bhattacharyya / ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ / k-means++ ã‚’è¨ˆç®—ã§ãã¾ã™ã€‚</p>
                <div class="grid2">
                    <div>
                        <strong>Jensen ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹</strong> â€” p, q (JSONé…åˆ—), F: <input type="text" id="d-jensen-p" placeholder="[0,0]" style="width:80px"> <input type="text" id="d-jensen-q" placeholder="[1,1]" style="width:80px">
                        <select id="d-jensen-f"><option value="squared">squared</option><option value="entropy">entropy</option></select>
                        <button onclick="calcJensen()">è¨ˆç®—</button>
                        <pre id="out-jensen" style="margin-top:6px; font-size:0.85rem; min-height:40px;"></pre>
                    </div>
                    <div>
                        <strong>ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen</strong> â€” p, q, Î±: <input type="text" id="d-skew-p" placeholder="[0,0]" style="width:70px"> <input type="text" id="d-skew-q" placeholder="[1,1]" style="width:70px"> <input type="number" id="d-skew-a" min="0.01" max="0.99" step="0.1" value="0.5" style="width:50px">
                        <button onclick="calcSkewJensen()">è¨ˆç®—</button>
                        <pre id="out-skew" style="margin-top:6px; font-size:0.85rem; min-height:40px;"></pre>
                    </div>
                    <div>
                        <strong>Bregman</strong> â€” p, q, F: <input type="text" id="d-bregman-p" placeholder="[1,1]" style="width:70px"> <input type="text" id="d-bregman-q" placeholder="[2,2]" style="width:70px">
                        <select id="d-bregman-f"><option value="squared">squared</option><option value="entropy">entropy</option></select>
                        <button onclick="calcBregman()">è¨ˆç®—</button>
                        <pre id="out-bregman" style="margin-top:6px; font-size:0.85rem; min-height:40px;"></pre>
                    </div>
                    <div>
                        <strong>Bhattacharyyaï¼ˆã‚¬ã‚¦ã‚¹ï¼‰</strong> â€” Î¼1,ÏƒÂ²1, Î¼2,ÏƒÂ²2: <input type="number" id="d-bhat-m1" value="0" style="width:50px"> <input type="number" id="d-bhat-v1" value="1" style="width:50px"> <input type="number" id="d-bhat-m2" value="1" style="width:50px"> <input type="number" id="d-bhat-v2" value="1" style="width:50px">
                        <button onclick="calcBhattacharyya()">è¨ˆç®—</button>
                        <pre id="out-bhat" style="margin-top:6px; font-size:0.85rem; min-height:40px;"></pre>
                    </div>
                    <div>
                        <strong>Chord gapï¼ˆè«–æ–‡ Eq.7 ä¸‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰</strong> â€” p, q, Î±, Î², Î³: <input type="text" id="d-chord-p" placeholder="[0,0]" style="width:60px"> <input type="text" id="d-chord-q" placeholder="[1,1]" style="width:60px"> <input type="number" id="d-chord-alpha" value="0" min="0" max="0.99" step="0.1" style="width:50px" title="Î±"> <input type="number" id="d-chord-beta" value="0.3" min="0.01" max="0.99" step="0.05" style="width:50px" title="Î²"> <input type="number" id="d-chord-gamma" value="0.5" min="0.01" max="0.99" step="0.05" style="width:50px" title="Î³">
                        <button onclick="calcChordGap()">è¨ˆç®—</button>
                        <pre id="out-chord" style="margin-top:6px; font-size:0.85rem; min-height:40px;"></pre>
                    </div>
                    <div>
                        <strong>Jensenâ€“Bregman (JB)</strong> â€” p, q, Î±: <input type="text" id="d-jb-p" placeholder="[1,1]" style="width:70px"> <input type="text" id="d-jb-q" placeholder="[2,2]" style="width:70px"> <input type="number" id="d-jb-a" value="0.5" min="0.01" max="0.99" step="0.1" style="width:50px">
                        <button onclick="calcJB()">è¨ˆç®—</button>
                        <pre id="out-jb" style="margin-top:6px; font-size:0.85rem; min-height:40px;"></pre>
                    </div>
                    <div>
                        <strong>ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ï¼ˆé‡ã¿ä»˜ãï¼‰</strong> â€” points: <input type="text" id="d-centroid-pts" placeholder="[[0,0],[1,0],[0,1]]" style="width:180px"> Î±: <input type="number" id="d-centroid-a" value="0.5" min="0.01" max="0.99" step="0.1" style="width:50px">
                        <button onclick="calcCentroid()">è¨ˆç®—</button>
                        <pre id="out-centroid" style="margin-top:6px; font-size:0.85rem; min-height:40px;"></pre>
                    </div>
                    <div>
                        <strong>k-means++ åˆæœŸã‚·ãƒ¼ãƒ‰</strong> â€” points: <input type="text" id="d-kmeans-pts" placeholder="[[0,0],[1,1],[2,0],[0,2]]" style="width:160px"> k: <input type="number" id="d-kmeans-k" value="2" min="1" style="width:40px">
                        <button onclick="calcKmeansPP()">è¨ˆç®—</button>
                        <pre id="out-kmeans" style="margin-top:6px; font-size:0.85rem; min-height:40px;"></pre>
                    </div>
                </div>
            </div>
            <div class="panel" style="border-color: var(--accent);">
                <h3>ğŸ“ éŸ³å£°å¤‰æ›ã®æå¤±å¼ï¼ˆè«–æ–‡ã©ãŠã‚Šï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">CycleGAN-VC: L_G = L_adv + Î»_cyc L_cyc + Î»_id L_idã€‚StarGAN-VC: L_G = L_adv + Î»_cls L_cls^r + Î»_cyc L_cyc + Î»_id L_idã€‚API ã§ä¸ãˆãŸãƒ­ã‚¸ãƒƒãƒˆãƒ»å†æ§‹æˆèª¤å·®ã‹ã‚‰æå¤±ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>
                <div class="grid2">
                    <div>
                        <strong>CycleGAN æå¤±</strong> â€” fake_logits, real_logits, reconstructed, original (é…åˆ—), Î»_cyc, Î»_id<br>
                        <input type="text" id="loss-fake" placeholder="[0.3,0.4]" style="width:80px"> <input type="text" id="loss-real" placeholder="[0.7,0.8]" style="width:80px"> <input type="text" id="loss-recon" placeholder="[0.1,0.2]" style="width:80px"> <input type="text" id="loss-orig" placeholder="[0.1,0.2]" style="width:80px">
                        <button onclick="calcCycleGANLoss()">è¨ˆç®—</button>
                        <pre id="out-cyclegan" style="margin-top:6px; font-size:0.85rem; min-height:50px;"></pre>
                    </div>
                    <div>
                        <strong>StarGAN æå¤±</strong> â€” fake/real logits, domain_fake/real, Î»_cls, Î»_cyc, Î»_id<br>
                        <input type="text" id="loss-s-fake" placeholder="[0.4]" style="width:60px"> <input type="text" id="loss-s-real" placeholder="[0.7]" style="width:60px"> <input type="text" id="loss-s-df" placeholder="[0.8]" style="width:60px"> <input type="text" id="loss-s-dr" placeholder="[0.9]" style="width:60px">
                        <button onclick="calcStarGANLoss()">è¨ˆç®—</button>
                        <pre id="out-stargan" style="margin-top:6px; font-size:0.85rem; min-height:50px;"></pre>
                    </div>
                </div>
            </div>
            <div class="panel">
                <h3>æ•°å€¤è¨ˆç®—ï¼ˆå…¨ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ãƒ»API ä¸è¦ï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 12px;">ç†è«–ã‚¿ãƒ–ã®å¼ã«åŸºã¥ãã€Jensen / Bregman / Bhattacharyya / Chord Gap / Jensenâ€“Bregman / ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ / k-means++ ã‚’<strong>ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§</strong>è¨ˆç®—ã—ã¾ã™ã€‚WAV ã‹ã‚‰åˆ†å¸ƒã‚’å–ã‚‹æ¯”è¼ƒã¯ã€ŒWAV åˆ†æã€ã‚¿ãƒ–ã®ã€Œ2ã¤ã® WAV ã®ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹æ¯”è¼ƒã€ã§è¡Œãˆã¾ã™ã€‚æ•°å¼ã®è©³ç´°ã¯<strong>ç†è«–ï¼ˆæ•°å¼ï¼‰</strong>ã‚¿ãƒ–ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p>
            </div>
            <div style="display:none;">
            <div class="panel">
                <h3>1. Jensen ä¸ç­‰å¼ã¨ Jensen ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆBurbeaâ€“Raoï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 10px;">$F$ ã‚’ç‹­ç¾©å‡¸é–¢æ•°ã¨ã™ã‚‹ã¨ãã€Jensen ã®ä¸ç­‰å¼ã‚ˆã‚Š</p>
                <div class="math-block">$$F\!\left(\frac{p+q}{2}\right) \leq \frac{F(p)+F(q)}{2}.$$</div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ã“ã®ä¸ç­‰å¼ã®ã‚®ãƒ£ãƒƒãƒ—ãŒ Jensen ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆBurbeaâ€“Raoï¼‰ã€‚è«–æ–‡ã§ã¯ Index terms: Jensen/Burbeaâ€“Rao divergence, Bregman divergence, centroid, k-means++ã€‚</p>
                <div class="math-block">$$J_F(p,q) = \frac{F(p)+F(q)}{2} - F\!\left(\frac{p+q}{2}\right) \geq 0.$$</div>
            </div>
            <div class="panel">
                <h3>2. ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\alpha \in (0,1)$ï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">é‡ã¿ä»˜ãå¹³å‡ $(1-\alpha)p + \alpha q$ ã«å¯¾ã™ã‚‹å‡¸ä¸ç­‰å¼ã®ã‚®ãƒ£ãƒƒãƒ—ã§ã€ãƒ‘ãƒ©ãƒ¡ãƒˆãƒªãƒƒã‚¯æ—ã‚’å®šç¾©ã™ã‚‹:</p>
                <div class="math-block">$$J_F^\alpha(p : q) = (1-\alpha)F(p) + \alpha F(q) - F\bigl((1-\alpha)p + \alpha q\bigr).$$</div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">åˆ¥è¡¨è¨˜ï¼ˆ$(pq)_\lambda := (1-\lambda)p + \lambda q$ ã¨ã—ã¦ï¼‰:</p>
                <div class="math-block">$$J_F^\alpha(p : q) = (F(p)\,F(q))_\alpha - F((pq)_\alpha), \quad \text{ä¸€èˆ¬ã«éå¯¾ç§° } J_F^\alpha(p:q) \neq J_F^\alpha(q:p).$$</div>
            </div>
            <div class="panel">
                <h3>3. Bregman ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã¨æ¥µé™</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">$F$ ãŒç‹­ç¾©å‡¸ã‹ã¤å¾®åˆ†å¯èƒ½ãªã¨ãã€Bregman ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã¯</p>
                <div class="math-block">$$B_F(p : q) = F(p) - F(q) - (p-q)^\top \nabla F(q).$$</div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã®ã‚¹ã‚±ãƒ¼ãƒ«ç‰ˆ $sJ_F^\alpha(p:q) = \frac{1}{1-\alpha} J_F^\alpha(p:q)$ ã¯ã€$\alpha \to 0^+$ ã¾ãŸã¯ $\alpha \to 1^-$ ã§ Bregman ã‚’æ¥µé™ã¨ã—ã¦å«ã‚€ã€‚Taylorâ€“Lagrange å½¢ï¼ˆä¸­é–“ç‚¹ $\xi \in [p,q]$ï¼‰:</p>
                <div class="math-block">$$B_F(p|q) = \frac{1}{2}(p-q)^\top \nabla^2 F(\xi)\,(p-q).$$</div>
            </div>
            <div class="panel">
                <h3>4. çµ±è¨ˆçš„è·é›¢ï¼šBhattacharyya ã¨ KL</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">åˆ†å¸ƒ $p(x), q(x)$ ã«å¯¾ã™ã‚‹ã‚¹ã‚­ãƒ¥ãƒ¼ Bhattacharyya è·é›¢ã¨ Kullbackâ€“Leibler:</p>
                <div class="math-block">$$\mathrm{Bhat}_\alpha(p : q) = -\log \int p(x)^{1-\alpha} q(x)^\alpha \,dx, \qquad \mathrm{KL}(p:q) = \int p(x) \log \frac{p(x)}{q(x)}\,dx.$$</div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">æŒ‡æ•°æ— $p(x;\theta) = \exp(\theta^\top x - F(\theta))$ ã§ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç©ºé–“ä¸Šã§ $\mathrm{Bhat}(p(\cdot;\theta_1) : p(\cdot;\theta_2)) = J_F^\alpha(\theta_1 : \theta_2)$ ã¨ä¸€è‡´ã—ã€$\mathrm{KL}$ ã¯ Bregman ã«å¯¾å¿œã™ã‚‹ï¼ˆFig. 1 ã®å¯¾å¿œï¼‰ã€‚</p>
            </div>
            <div class="panel">
                <h3>5. Chord Gap ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆä¸‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ—ï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">Nielsen ã¯ã€Œä¸Šå¼¦ã€ã¨ã€Œä¸‹å¼¦ã€ã®å‚ç›´ã‚®ãƒ£ãƒƒãƒ—ã¨ã—ã¦ chord gap ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ $J_F^{\alpha,\beta,\gamma}(p:q)$ ã‚’å°å…¥ã—ã€ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã¨çµ±è¨ˆçš„ Bhattacharyya ã‚’ä¸€èˆ¬åŒ–ã™ã‚‹ã€‚äºŒã¤ã®ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã®å·®ã¨ã—ã¦:</p>
                <div class="math-block">$$J_F^{\beta,\gamma}(p:q) = J_F^\alpha(p:q) - J_F^\alpha((pq)_\alpha : (pq)_s), \quad \lambda = \lambda(\alpha,\beta,\gamma).$$</div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ä¸€èˆ¬åŒ– Bhattacharyya è·é›¢ï¼ˆæŒ‡æ•°æ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\theta_p, \theta_q$ï¼‰ã¯ä¸‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ— $\mathrm{Bhat}_{\alpha,\beta,\gamma}(\theta_p : \theta_q)$ ã¨ã—ã¦å®šç¾©ã•ã‚Œã€$\alpha=\beta$ ã®ã¨ãå¾“æ¥ã®ã‚¹ã‚­ãƒ¥ãƒ¼ Bhattacharyya ã«å¸°ç€ã™ã‚‹ã€‚</p>
            </div>
            <div class="panel">
                <h3>6. ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ã¨ k-means++</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">é‡ã¿ä»˜ãç‚¹é›†åˆ $P = \{(w_i, p_i)\}$ ã«å¯¾ã™ã‚‹ chord gap ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ã¯ã€$A(x)-B(x)$ï¼ˆ$A,B$ ã¯ç‹­ç¾©å‡¸ï¼‰ã®æœ€å°åŒ–ã¨ãªã‚Šã€åå¾©çš„ concaveâ€“convex procedure (CCCP) ã§è§£ã:</p>
                <div class="math-block">$$\nabla A(x_{t+1}) = \nabla B(x_t), \qquad x_{t+1} = (\nabla A)^{-1}(\nabla B(x_t)).$$</div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">$\alpha=\beta=\gamma$ ã®ã¨ãã€ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ã®æ›´æ–°ã¯ $x_{t+1} = \nabla F^{-1}\bigl(\sum_i w_i \nabla F((p_i x_t)_\alpha)\bigr)$ã€‚k-means++ ã®ç«¶åˆæ¯”ã¯ã€ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ãŒ $U$-ä¸‰è§’ä¸ç­‰å¼ $D(x:z) \leq U(D(x:y)+D(y:z))$ ã‚’æº€ãŸã™ã¨ã $O(\log k)$ ã®ä¿è¨¼ã‚’æŒã¤ã€‚</p>
            </div>
            <div class="panel">
                <h3>7. Skew Jensenâ€“Bregman (JB) ã¨ Taylorâ€“Lagrange å½¢</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ã‚¹ã‚­ãƒ¥ãƒ¼ Jensenâ€“Bregman ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã¯äºŒã¤ã® Bregman ã®é‡ã¿ä»˜ãå’Œ:</p>
                <div class="math-block">$$\mathrm{JB}_F^\alpha(p|q) = (1-\alpha) B_F(p : (pq)_\alpha) + \alpha B_F(q : (pq)_\alpha).$$</div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã® Taylorâ€“Lagrange å½¢ï¼ˆä¸­é–“ç‚¹ $\xi_1, \xi_2$ï¼‰ã¯ $H_\alpha^{p|q}$ ã‚’ç”¨ã„ã¦ $J_F^\alpha(p|q)$ ã¨çµã³ã¤ãã€ä¸‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ chord gap ã® Taylorâ€“Lagrange å½¢ $H_{\alpha,\beta,\gamma}^{p|q}$ ã¯ $\nabla^2 F(\xi'), \nabla^2 F(\xi'')$ ã§è¡¨ã•ã‚Œã‚‹ã€‚æœ‰é™ç‚¹é›†åˆ $P$ ä¸Šã§æ¯” $\rho = \sup/\inf$ ãŒæœ‰é™ãªã‚‰ã€k-means++ ã®è§£æã«åˆ©ç”¨ã§ãã‚‹ã€‚</p>
            </div>
            <div class="panel">
                <h3>8. å®Ÿè£…ã—ãŸå¼ã®ä¸€è¦§ï¼ˆè«–æ–‡ã©ãŠã‚Šï¼‰</h3>
                <p style="color: var(--text-muted); margin-bottom: 8px;">æœ¬ã‚µã‚¤ãƒˆã® API ã§è¨ˆç®—ã—ã¦ã„ã‚‹å¼:</p>
                <ul style="color: var(--text-muted); padding-left: 20px; line-height: 2;">
                    <li><strong>Jensen</strong> â€” $J_F(p,q) = \frac{F(p)+F(q)}{2} - F((p+q)/2)$ï¼ˆF: squared / entropyï¼‰</li>
                    <li><strong>ã‚¹ã‚­ãƒ¥ãƒ¼ Jensen</strong> â€” $J_F^\alpha(p:q) = (1-\alpha)F(p) + \alpha F(q) - F((1-\alpha)p + \alpha q)$</li>
                    <li><strong>Bregman</strong> â€” $B_F(p:q) = F(p) - F(q) - (p-q)^\top \nabla F(q)$</li>
                    <li><strong>Skew Jensenâ€“Bregman</strong> â€” $\mathrm{JB}_F^\alpha(p|q) = (1-\alpha)B_F(p:(pq)_\alpha) + \alpha B_F(q:(pq)_\alpha)$</li>
                    <li><strong>Bhattacharyya</strong> â€” ã‚¬ã‚¦ã‚¹åŒå£«ã®é–‰å½¢å¼ã€é›¢æ•£åˆ†å¸ƒã® $-\log \sum\sqrt{p_i q_i}$</li>
                    <li><strong>Chord gap</strong> â€” äºŒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ— $J_F^{\beta,\gamma}(p:q)$ï¼ˆä¸Šè¨˜è¨ˆç®—ãƒ‡ãƒ¢ã® API ã§è¨ˆç®—å¯èƒ½ï¼‰</li>
                    <li><strong>ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰</strong> â€” é‡ã¿ä»˜ãã‚¹ã‚­ãƒ¥ãƒ¼ Jensen ã‚»ãƒ³ãƒˆãƒ­ã‚¤ãƒ‰ï¼ˆF=squared ã¯é–‰å½¢å¼ã§é‡ã¿ä»˜ãå¹³å‡ï¼‰</li>
                    <li><strong>k-means++</strong> â€” ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã«åŸºã¥ã $D^2$ é‡ã¿ä»˜ãç¢ºç‡ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã§åˆæœŸã‚·ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ</li>
                    <li><strong>CycleGAN-VC æå¤±</strong> â€” $L_G = L_{adv} + \lambda_{cyc} L_{cyc} + \lambda_{id} L_{id}$</li>
                    <li><strong>StarGAN-VC æå¤±</strong> â€” $L_G = L_{adv} + \lambda_{cls} L_{cls}^r + \lambda_{cyc} L_{cyc} + \lambda_{id} L_{id}$</li>
                </ul>
            </div>
            <div class="panel paper-ref">
                <h4>å‚è€ƒæ–‡çŒ®</h4>
                <p><strong>Frank Nielsen</strong>, "The chord gap divergence and a generalization of the Bhattacharyya distance," Ã‰cole Polytechnique &amp; Sony CSL. Index terms: Jensen/Burbeaâ€“Rao divergence, Bregman divergence, centroid, k-means++. å†ç¾ç”¨ã‚³ãƒ¼ãƒ‰: <a href="https://www.lix.polytechnique.fr/~nielsen/CGD/" target="_blank" rel="noopener" style="color: var(--accent);">lix.polytechnique.fr/~nielsen/CGD/</a></p>
            </div>
            </div>
        </div>

        <div id="advanced" class="tab-content">
            <div class="panel">
                <h3>è©³ç´°ãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸</h3>
                <p style="margin-bottom:12px;">å„æ‰‹æ³•ã®æ•°å¼ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ»ç°¡æ˜“ãƒ‡ãƒ¢ã‚’ã¾ã¨ã‚ãŸãƒšãƒ¼ã‚¸ã§ã™ã€‚</p>
                <a href="research.html" style="color: var(--accent); font-weight: 600;">research.html ã‚’é–‹ã â†’</a>
            </div>
        </div>

        <footer class="footer-ack">
            <p><strong>è¬è¾</strong> â€” ç†è«–ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ã¯ Frank Nielsen (Chord Gap, Jensen/Bregman/Bhattacharyya) ã«åŸºã¥ãã¾ã™ã€‚éŸ³å£°ãƒ»è«–æ–‡å‚ç…§ã¯å›½éš›ä¼šè­° (NIPS, ICASSP, NeurIPS, ICML, EUSIPCO, SLT) ã®è‘—è€…ã«æ•¬æ„ã‚’è¡¨ã—ã¾ã™ã€‚</p>
        </footer>
    </div>

    <script>
        function switchTab(id, el) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if (el) el.classList.add('active');
            if (id === 'divergence' || id === 'theory') {
                loadMathJaxIfNeeded(function() {
                    if (window.MathJax && window.MathJax.typesetPromise) window.MathJax.typesetPromise([document.getElementById(id)]).catch(function() {});
                });
            }
        }
        function parseJson(id, def) { try { return JSON.parse(document.getElementById(id).value || def); } catch (e) { return def; } }

        // ========== ãƒ€ã‚¤ãƒãƒ¼ã‚¸ã‚§ãƒ³ã‚¹ï¼ˆå…¨ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ï¼‰ ==========
        var eps = 1e-12;
        function F_squared(x) { return x.reduce(function(s, v) { return s + v * v; }, 0); }
        function grad_F_squared(x) { return x.map(function(v) { return 2 * v; }); }
        function F_entropy(x) { return x.reduce(function(s, v) { v += eps; return s + v * Math.log(v); }, 0); }
        function grad_F_entropy(x) { return x.map(function(v) { return 1 + Math.log(v + eps); }); }
        function dot(a, b) { return a.reduce(function(s, v, i) { return s + v * b[i]; }, 0); }
        function jensen_div(p, q, Fname) {
            var F = Fname === 'entropy' ? F_entropy : F_squared;
            var mid = p.map(function(_, i) { return (p[i] + q[i]) / 2; });
            return (F(p) + F(q)) / 2 - F(mid);
        }
        function skew_jensen(p, q, alpha, Fname) {
            var F = Fname === 'entropy' ? F_entropy : F_squared;
            alpha = Math.max(eps, Math.min(1 - eps, alpha));
            var mid = p.map(function(_, i) { return (1 - alpha) * p[i] + alpha * q[i]; });
            return (1 - alpha) * F(p) + alpha * F(q) - F(mid);
        }
        function bregman(p, q, Fname) {
            var F = Fname === 'entropy' ? F_entropy : F_squared;
            var g = Fname === 'entropy' ? grad_F_entropy : grad_F_squared;
            return F(p) - F(q) - dot(p.map(function(v, i) { return v - q[i]; }), g(q));
        }
        function jensen_bregman(p, q, alpha, Fname) {
            alpha = Math.max(eps, Math.min(1 - eps, alpha));
            var mid = p.map(function(_, i) { return (1 - alpha) * p[i] + alpha * q[i]; });
            return (1 - alpha) * bregman(p, mid, Fname) + alpha * bregman(q, mid, Fname);
        }
        function bhattacharyya_disc(p, q) {
            var sp = p.reduce(function(a, b) { return a + b; }, 0) + eps, sq = q.reduce(function(a, b) { return a + b; }, 0) + eps;
            var pp = p.map(function(v) { return v / sp; }), qq = q.map(function(v) { return v / sq; });
            var bc = pp.reduce(function(s, v, i) { return s + Math.sqrt(Math.max(0, v * qq[i])); }, 0);
            bc = Math.max(eps, Math.min(1, bc));
            return -Math.log(bc);
        }
        function bhattacharyya_gauss(m1, v1, m2, v2) {
            v1 += eps; v2 += eps;
            var v = (v1 + v2) / 2;
            var bc = Math.exp(-(m1 - m2) * (m1 - m2) / (4 * v)) / Math.sqrt(2 * Math.PI * Math.sqrt(v1 * v2));
            bc = Math.max(eps, Math.min(1, bc));
            return -Math.log(bc);
        }
        function chord_gap(p, q, alpha, beta, gamma, Fname) {
            alpha = Math.max(eps, Math.min(1 - eps, alpha));
            beta = Math.max(eps, Math.min(1 - eps, beta));
            gamma = Math.max(eps, Math.min(1 - eps, gamma));
            var pq_alpha = p.map(function(_, i) { return (1 - alpha) * p[i] + alpha * q[i]; });
            var pq_beta = p.map(function(_, i) { return (1 - beta) * p[i] + beta * q[i]; });
            var j1 = skew_jensen(p, q, gamma, Fname);
            var lambda = (Math.abs(beta - alpha) < eps) ? 0.5 : (gamma - alpha) / (beta - alpha);
            lambda = Math.max(eps, Math.min(1 - eps, lambda));
            var j2 = skew_jensen(pq_alpha, pq_beta, lambda, Fname);
            return j1 - j2;
        }
        function skew_bhattacharyya_disc(p, q, alpha) {
            alpha = Math.max(eps, Math.min(1 - eps, alpha));
            var sp = p.reduce(function(a, b) { return a + b; }, 0) + eps, sq = q.reduce(function(a, b) { return a + b; }, 0) + eps;
            var pp = p.map(function(v) { return Math.max(eps, v / sp); }), qq = q.map(function(v) { return Math.max(eps, v / sq); });
            var sum = pp.reduce(function(s, v, i) { return s + Math.pow(v, 1 - alpha) * Math.pow(qq[i], alpha); }, 0);
            return -Math.log(Math.max(eps, sum));
        }
        function centroid(points, weights) {
            var wsum = weights.reduce(function(a, b) { return a + b; }, 0) + eps;
            var w = weights.map(function(v) { return v / wsum; });
            return points[0].map(function(_, d) { return points.reduce(function(s, pt, i) { return s + pt[d] * w[i]; }, 0); });
        }

        function calcJensen() {
            var p = parseJson('d-jensen-p', '[0,0]'), q = parseJson('d-jensen-q', '[1,1]'), F = document.getElementById('d-jensen-f').value;
            document.getElementById('out-jensen').textContent = JSON.stringify({ 'J_F(p,q)': jensen_div(p, q, F) }, null, 2);
        }
        function calcSkewJensen() {
            var p = parseJson('d-skew-p', '[0,0]'), q = parseJson('d-skew-q', '[1,1]'), alpha = parseFloat(document.getElementById('d-skew-a').value);
            document.getElementById('out-skew').textContent = JSON.stringify({
                'J_F^alpha(p:q)': skew_jensen(p, q, alpha, 'squared'),
                'J_F^alpha(q:p)': skew_jensen(q, p, alpha, 'squared')
            }, null, 2);
        }
        function calcBregman() {
            var p = parseJson('d-bregman-p', '[1,1]'), q = parseJson('d-bregman-q', '[2,2]'), F = document.getElementById('d-bregman-f').value;
            document.getElementById('out-bregman').textContent = JSON.stringify({ 'B_F(p:q)': bregman(p, q, F) }, null, 2);
        }
        function calcBhattacharyya() {
            var m1 = parseFloat(document.getElementById('d-bhat-m1').value), v1 = parseFloat(document.getElementById('d-bhat-v1').value), m2 = parseFloat(document.getElementById('d-bhat-m2').value), v2 = parseFloat(document.getElementById('d-bhat-v2').value);
            document.getElementById('out-bhat').textContent = JSON.stringify({ Bhattacharyya_distance_gaussian: bhattacharyya_gauss(m1, v1, m2, v2) }, null, 2);
        }
        function calcChordGap() {
            var p = parseJson('d-chord-p', '[0,0]'), q = parseJson('d-chord-q', '[1,1]'), alpha = parseFloat(document.getElementById('d-chord-alpha').value) || 0, beta = parseFloat(document.getElementById('d-chord-beta').value), gamma = parseFloat(document.getElementById('d-chord-gamma').value);
            document.getElementById('out-chord').textContent = JSON.stringify({ 'J_F^{Î±,Î²,Î³}(p:q)': chord_gap(p, q, alpha, beta, gamma, 'squared') }, null, 2);
        }
        function calcJB() {
            var p = parseJson('d-jb-p', '[1,1]'), q = parseJson('d-jb-q', '[2,2]'), alpha = parseFloat(document.getElementById('d-jb-a').value);
            document.getElementById('out-jb').textContent = JSON.stringify({ 'JB_F^alpha(p|q)': jensen_bregman(p, q, alpha, 'squared') }, null, 2);
        }
        function calcCentroid() {
            var points = parseJson('d-centroid-pts', '[[0,0],[1,0],[0,1]]'), alpha = parseFloat(document.getElementById('d-centroid-a').value);
            var w = points.map(function() { return 1 / points.length; });
            document.getElementById('out-centroid').textContent = JSON.stringify({ centroid: centroid(points, w) }, null, 2);
        }
        function calcKmeansPP() {
            var points = parseJson('d-kmeans-pts', '[[0,0],[1,1],[2,0],[0,2]]'), k = parseInt(document.getElementById('d-kmeans-k').value, 10);
            if (k >= points.length) { document.getElementById('out-kmeans').textContent = JSON.stringify({ seeds: points }, null, 2); return; }
            var indices = [0];
            for (var r = 0; r < k - 1; r++) {
                var d2 = points.map(function(pt, i) {
                    if (indices.indexOf(i) >= 0) return 0;
                    return Math.min.apply(null, indices.map(function(c) { return Math.max(0, skew_jensen(pt, points[c], 0.5, 'squared')); }));
                });
                var sum = d2.reduce(function(a, b) { return a + b; }, 0) + eps;
                var probs = d2.map(function(v) { return v / sum; });
                var cum = 0, rnd = Math.random();
                for (var i = 0; i < probs.length; i++) { cum += probs[i]; if (rnd <= cum) { indices.push(i); break; } }
            }
            document.getElementById('out-kmeans').textContent = JSON.stringify({ seeds: indices.map(function(i) { return points[i]; }) }, null, 2);
        }
        function calcCycleGANLoss() {
            document.getElementById('out-cyclegan').textContent = 'L_G = L_adv + Î»_cyc L_cyc + Î»_id L_idï¼ˆè«–æ–‡å‚ç…§ã‚¿ãƒ–ã§æ•°å¼ã‚’ç¢ºèªï¼‰ã€‚\næœ¬ã‚µã‚¤ãƒˆã¯ API ã«ä¾å­˜ã—ãªã„ãŸã‚ã€æå¤±ã®æ•°å€¤è¨ˆç®—ã¯è¡Œã£ã¦ã„ã¾ã›ã‚“ã€‚';
        }
        function calcStarGANLoss() {
            document.getElementById('out-stargan').textContent = 'L_G = L_adv + Î»_cls L_cls^r + Î»_cyc L_cyc + Î»_id L_idï¼ˆè«–æ–‡å‚ç…§ã‚¿ãƒ–ã§æ•°å¼ã‚’ç¢ºèªï¼‰ã€‚\næœ¬ã‚µã‚¤ãƒˆã¯ API ã«ä¾å­˜ã—ãªã„ãŸã‚ã€æå¤±ã®æ•°å€¤è¨ˆç®—ã¯è¡Œã£ã¦ã„ã¾ã›ã‚“ã€‚';
        }
        let demoAudioBuffer = null;
        document.getElementById('demo-spectrum-file').onchange = async function(e) {
            var f = e.target.files[0]; if (!f) return;
            var url = URL.createObjectURL(f);
            document.getElementById('demo-audio').src = url;
            var ctx = new (window.AudioContext || window.webkitAudioContext)();
            var ab = await fetch(url).then(r => r.arrayBuffer());
            demoAudioBuffer = await ctx.decodeAudioData(ab);
            drawWaveform(demoAudioBuffer, 'demo-waveform');
            drawSpectrogramSimple(demoAudioBuffer, 'demo-spectrogram');
            URL.revokeObjectURL(url);
        };
        function drawWaveform(buffer, canvasId) {
            var canvas = document.getElementById(canvasId); if (!canvas || !buffer) return;
            var ctx = canvas.getContext('2d'), w = canvas.width = canvas.offsetWidth, h = canvas.height;
            var ch = buffer.getChannelData(0), step = Math.floor(ch.length / w);
            ctx.fillStyle = '#0f172a'; ctx.fillRect(0, 0, w, h);
            ctx.strokeStyle = '#3b82f6'; ctx.beginPath();
            for (var x = 0; x < w; x++) { var i = Math.min(x * step, ch.length - 1), y = (1 - ch[i]) / 2 * h; if (x === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y); }
            ctx.stroke();
        }
        function drawSpectrogramSimple(buffer, canvasId) {
            var canvas = document.getElementById(canvasId); if (!canvas || !buffer) return;
            var ctx = canvas.getContext('2d'), w = Math.min(512, canvas.offsetWidth || 400), h = Math.min(256, canvas.height || 200);
            var ch = buffer.getChannelData(0), fftSize = 1024, hop = fftSize;
            var win = new Float32Array(fftSize); for (var i = 0; i < fftSize; i++) win[i] = 0.5 - 0.5 * Math.cos(2 * Math.PI * i / (fftSize - 1));
            var nFrames = Math.floor((ch.length - fftSize) / hop) + 1;
            var step = Math.max(1, Math.floor(nFrames / w));
            var outW = Math.min(w, Math.ceil(nFrames / step)), outH = Math.floor(fftSize / 2);
            var mag = new Float32Array(outW * outH);
            for (var fi = 0; fi < outW; fi++) {
                var start = (fi * step) * hop;
                if (start + fftSize > ch.length) break;
                var re = new Float32Array(fftSize), im = new Float32Array(fftSize);
                for (var i = 0; i < fftSize; i++) { re[i] = ch[start + i] * win[i]; im[i] = 0; }
                fftRadix2(re, im);
                for (var k = 0; k < outH; k++) mag[fi + k * outW] = Math.sqrt(re[k] * re[k] + im[k] * im[k]);
            }
            var max = 0; for (var i = 0; i < mag.length; i++) if (mag[i] > max) max = mag[i];
            var img = ctx.createImageData(outW, outH);
            for (var y = 0; y < outH; y++) for (var x = 0; x < outW; x++) {
                var v = Math.min(1, mag[x + y * outW] / (max || 1)), i = (y * outW + x) * 4;
                img.data[i] = v * 255; img.data[i+1] = v * 100; img.data[i+2] = 200; img.data[i+3] = 255;
            }
            canvas.width = outW; canvas.height = outH; ctx.putImageData(img, 0, 0);
        }
        function fftRadix2(re, im) {
            var n = re.length, i, j, k, len, half, t, ur, ui, wr, wi, tr, ti;
            for (i = 0; i < n; i++) {
                j = 0; for (k = 0; k < 10; k++) j = (j << 1) | ((i >> k) & 1);
                if (j > i) { t = re[i]; re[i] = re[j]; re[j] = t; t = im[i]; im[i] = im[j]; im[j] = t; }
            }
            for (len = 2; len <= n; len *= 2) {
                half = len / 2; var angle = -2 * Math.PI / len; wr = Math.cos(angle); wi = Math.sin(angle);
                for (k = 0; k < n; k += len) {
                    ur = 1; ui = 0;
                    for (j = 0; j < half; j++) {
                        tr = re[k + j + half] * ur - im[k + j + half] * ui;
                        ti = re[k + j + half] * ui + im[k + j + half] * ur;
                        re[k + j + half] = re[k + j] - tr; im[k + j + half] = im[k + j] - ti;
                        re[k + j] += tr; im[k + j] += ti;
                        t = ur * wr - ui * wi; ui = ur * wi + ui * wr; ur = t;
                    }
                }
            }
        }
        function demoSpectrum() { var el = document.getElementById('demo-spectrum-file'); if (el.files.length === 0) { alert('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã‚“ã§ãã ã•ã„'); return; } el.dispatchEvent(new Event('change')); }

        function spectrumToDistribution(buffer, bins) {
            bins = bins || 32;
            var ch = buffer.getChannelData(0), fftSize = 1024, hop = fftSize, maxFrames = 80;
            var win = new Float32Array(fftSize); for (var i = 0; i < fftSize; i++) win[i] = 0.5 - 0.5 * Math.cos(2 * Math.PI * i / (fftSize - 1));
            var hist = new Float32Array(bins);
            var nFrames = Math.floor((ch.length - fftSize) / hop) + 1;
            var step = Math.max(1, Math.floor(nFrames / maxFrames));
            var count = 0;
            for (var fi = 0; fi < nFrames && count < maxFrames; fi += step) {
                count++;
                var start = fi * hop;
                if (start + fftSize > ch.length) break;
                var re = new Float32Array(fftSize), im = new Float32Array(fftSize);
                for (var i = 0; i < fftSize; i++) { re[i] = ch[start + i] * win[i]; im[i] = 0; }
                fftRadix2(re, im);
                for (var k = 0; k < Math.floor(fftSize / 2); k++) {
                    var mag = Math.sqrt(re[k] * re[k] + im[k] * im[k]);
                    var bin = Math.min(bins - 1, Math.floor((k / (fftSize / 2)) * bins));
                    hist[bin] += mag;
                }
            }
            var sum = hist.reduce(function(a, b) { return a + b; }, 0) + eps;
            return Array.from(hist).map(function(v) { return v / sum; });
        }
        document.getElementById('div-wav-a').onchange = function() { document.getElementById('div-wav-a-label').textContent = this.files[0] ? this.files[0].name : 'æœªé¸æŠ'; };
        document.getElementById('div-wav-b').onchange = function() { document.getElementById('div-wav-b-label').textContent = this.files[0] ? this.files[0].name : 'æœªé¸æŠ'; };
        async function runDivergenceFromWav() {
            var fa = document.getElementById('div-wav-a').files[0], fb = document.getElementById('div-wav-b').files[0];
            if (!fa || !fb) { document.getElementById('div-wav-result').textContent = 'WAV A ã¨ WAV B ã®ä¸¡æ–¹ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚'; return; }
            var ctx = new (window.AudioContext || window.webkitAudioContext)();
            try {
                document.getElementById('div-wav-result').textContent = 'èª­ã¿è¾¼ã¿ä¸­â€¦';
                var bufA = await fetch(URL.createObjectURL(fa)).then(function(r) { return r.arrayBuffer(); }).then(function(ab) { return ctx.decodeAudioData(ab); });
                var bufB = await fetch(URL.createObjectURL(fb)).then(function(r) { return r.arrayBuffer(); }).then(function(ab) { return ctx.decodeAudioData(ab); });
                var p = spectrumToDistribution(bufA), q = spectrumToDistribution(bufB);
                var bins = p.length;
                var lines = [];
                lines.push('========== è¨ˆç®—éç¨‹ï¼ˆè«–æ–‡ã®å¼ã«å¾“ã†ï¼‰ ==========');
                lines.push('1) WAV A â†’ ãƒ‘ãƒ¯ãƒ¼ã‚¹ãƒšã‚¯ãƒˆãƒ« FFT â†’ ãƒ“ãƒ³æ•° ' + bins + ' ã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ  â†’ æ­£è¦åŒ–ã—ã¦åˆ†å¸ƒ p');
                lines.push('2) WAV B â†’ åŒæ§˜ã«åˆ†å¸ƒ q');
                lines.push('3) ä»¥ä¸‹ã€ã™ã¹ã¦ F=squaredï¼ˆãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ï¼‰ã§è¨ˆç®—ã€‚');
                lines.push('');
                lines.push('--- é©ç”¨ã—ãŸæ•°å¼ã¨çµæœ ---');
                var J = jensen_div(p, q, 'squared');
                lines.push('Jensen (Burbeaâ€“Rao): J_F(p,q) = (F(p)+F(q))/2 - F((p+q)/2)  =>  ' + J.toFixed(6));
                var B = bregman(p, q, 'squared');
                lines.push('Bregman: B_F(p:q) = F(p)-F(q)-(p-q)^T âˆ‡F(q)  =>  ' + B.toFixed(6));
                var JB = jensen_bregman(p, q, 0.5, 'squared');
                lines.push('Jensenâ€“Bregman (Î±=1/2): JB_F^Î±(p|q) = (1-Î±)B_F(p:(pq)_Î±)+Î± B_F(q:(pq)_Î±)  =>  ' + JB.toFixed(6));
                var Bhat = bhattacharyya_disc(p, q);
                lines.push('Bhattacharyya (é›¢æ•£): -log Î£âˆš(p_i q_i)  =>  ' + Bhat.toFixed(6));
                var BhatHalf = skew_bhattacharyya_disc(p, q, 0.5);
                lines.push('ã‚¹ã‚­ãƒ¥ãƒ¼ Bhattacharyya (Î±=1/2, è«–æ–‡ Eq.4): -log Î£ p_i^(1-Î±) q_i^Î±  =>  ' + BhatHalf.toFixed(6));
                var CG = chord_gap(p, q, 0, 0.5, 0.25, 'squared');
                lines.push('Chord Gap (Î±=0, Î²=0.5, Î³=0.25, è«–æ–‡ Eq.7): J_F^Î³(p:q) - J_F^Î»((pq)_Î±:(pq)_Î²), Î»=(Î³-Î±)/(Î²-Î±)  =>  ' + CG.toFixed(6));
                lines.push('');
                lines.push('========== æ•°å€¤ã¾ã¨ã‚ ==========');
                lines.push(JSON.stringify({
                    Jensen_squared: J,
                    Bregman_squared: B,
                    Jensen_Bregman_alpha_half: JB,
                    Bhattacharyya_discrete: Bhat,
                    Skew_Bhattacharyya_alpha_half: BhatHalf,
                    Chord_Gap_alpha0_beta0_5_gamma0_25: CG
                }, null, 2));
                document.getElementById('div-wav-result').textContent = lines.join('\n');
            } catch (e) { document.getElementById('div-wav-result').textContent = 'ã‚¨ãƒ©ãƒ¼: ' + e.message; }
        }
    </script>
</body>
</html>
